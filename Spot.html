<!DOCTYPE html>
<html lang="en">
    <head>
        <title>Prathamesh Saraf</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="author" content="owwwlab.com">
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
        
        <meta name="description" content="Prathamesh Saraf UCSD BITS Pilani" />
        <meta name="keywords" content="Prathamesh Saraf, UCSD, BITS Pilani" />

        <link rel="shortcut icon" href="./images/ucsdprofilepic.jpeg">

        <!--CSS styles-->
        <link rel="stylesheet" href="css/bootstrap.css">
        <link rel="stylesheet" href="css/font-awesome.min.css">  
        <link rel="stylesheet" href="css/perfect-scrollbar-0.4.5.min.css">
        <link rel="stylesheet" href="css/magnific-popup.css">
        <link rel="stylesheet" href="css/style.css">
        <link id="theme-style" rel="stylesheet" href="css/styles/blue.css">

        
        <!--/CSS styles-->
        <!--Javascript files-->
        <script type="text/javascript" src="js/jquery-1.11.3.min.js"></script>
        <script type="text/javascript" src="js/TweenMax.min.js"></script>
        <script type="text/javascript" src="js/jquery.touchSwipe.min.js"></script>
        <script type="text/javascript" src="js/jquery.carouFredSel-6.2.1-packed.js"></script>

        
        <script type="text/javascript" src="js/modernizr.custom.63321.js"></script>
        <script type="text/javascript" src="js/jquery.dropdownit.js"></script>

        <script type="text/javascript" src="js/ScrollToPlugin.min.js"></script>

        <script type="text/javascript" src="js/bootstrap.min.js"></script>

        <script type="text/javascript" src="js/jquery.mixitup.min.js"></script>

        <script type="text/javascript" src="js/masonry.min.js"></script>

        <script type="text/javascript" src="js/perfect-scrollbar-0.4.5.with-mousewheel.min.js"></script>
        <script type="text/javascript" src="js/jquery.nicescroll.min.js"></script>


        <script type="text/javascript" src="js/magnific-popup.js"></script>
        <script type="text/javascript" src="js/custom.js"></script>

        <!--/Javascript files-->

    </head>
    <body>

        <div id="wrapper">
            <a href="#sidebar" class="mobilemenu"><i class="fa fa-reorder"></i></a>
            <div id="sidebar">
                <div id="sidebar-wrapper">
                    <div id="sidebar-inner">
                        <!-- Profile/logo section-->
                        <div id="profile" class="clearfix">
                            <a href="index.html">
                                <div class="portrait hidden-xs"></div>
                                <div class="title">
                                    <h3>Prathamesh Saraf</h3>
                                    <!-- <h3>University of Southern California</h3> -->
                            </a>
                            <a title="UCSD" href="https://ucsd.edu/" target="_blank">
                                <h5 style="color: #aaa"> MS in ECE (Intelligent Systems, Robotics, and Controls),</h5> 
                                <h5 style="margin-top: -3%; color: #aaa;"> University of California San Diego </h5>
                            </a>
                        </div>   
                    </div>
                        <!-- /Profile/logo section-->

                        <!-- Main navigation-->
                        <div id="main-nav">
                            <ul id="navigation">
                                <li class="currentmenu">
                                  <a href="index.html">
                                    <i class="fa fa-user"></i>
                                    <div class="text">About</div>
                                  </a>
                                </li>  
                                
                                <li>
                                  <a href="research.html">
                                    <i class="fa fa-edit"></i>
                                    <div class="text">Work</div>
                                  </a>
                                </li> 
                                
                                <!-- <li>
                                  <a href="publication.html">
                                    <i class="fa fa-edit"></i>
                                    <div class="text">Publications</div>
                                  </a>
                                </li>  -->


                                <li>
                                  <a href="life.html">
                                    <i class='fa fa-heartbeat'></i>
                                      <div class="text">Life</div>
                                  </a>
                                </li>


                                <li>
                                  <a href="contact.html">
                                      <i class="fa fa-map-marker"></i>
                                      <div class="text">Find Me</div>
                                  </a>
                                </li>

                            </ul>
                        </div>


                        <!-- Social media -->

                        <div id="rcorners">
                            <div class="grid-container">
                                    <item><a title="Email" href="mailto:psaraf@ucsd.edu"><i class="fa fa-envelope"></i></a></item>
                                    <item><a title="GitHub" href="https://github.com/Prathamesh-Saraf" target="_blank"><i class="fa fa-github""></i></a></item>
                                    <item><a title="Google Scholar" href="https://scholar.google.com/citations?user=_dryk6EAAAAJ&hl=en" target="_blank"><i class="fa fa-graduation-cap" style="transform: scale(-1, 1);"></i></a></item>
                                    <item><a title="LinkedIn" href="https://www.linkedin.com/in/prathamesh-saraf/" target="_blank"><i class="fa fa-linkedin"></i></a></item>
                                    <item><a title="Facebook" href="https://www.facebook.com/profile.php?id=100006802470222" target="_blank"><i class="fa fa-facebook-official"></i></a></item>
                                    <item><a title="Instagram" href="https://www.instagram.com/prathamesh.saraf/" target="_blank"><i class="fa fa-instagram"></i></a></item>
                                    <item></item>
                                    <!-- <item>
                                        <a title="Resume" href="https://drive.google.com/file/d/1wxloraTS4kUvf7WtTnpk8pEpm3jT1Eux/view?usp=sharing" target="_blank"><i class="fa fa-file"></i></a>                                  
                                    </item> -->
                                    <item>
                                        <a title="Resume" href="https://drive.google.com/file/d/1D-4ANRKKPW9bSC9HnnjGI08Irxtf14B3/view?usp=sharing" target="_blank">
                                            <span class="fa-stack fa-1x">
                                                <i class="fa fa-file fa-stack-1x"></i>
                                                  <span class="fa fa-stack-1x" style="color:rgb(0, 0, 0);">
                                                      <span style="font-size:11px; margin-top:0px; font-weight: bold;">
                                                          CV
                                                      </span>
                                                </span>
                                            </span>	
                                    
                                        </a>
                                    </item>
                                    <item></item>
                            </div>
                        </div>

                        <!-- /Main navigation-->
                        <!-- Sidebar footer -->
                        <div id="sidebar-footer">
                            <div class="lastupdate">Last Updated: September 2022</div>
                            <!-- <div class="social-icons">
                                <ul>
                                    <li><a href="https://github.com/agnihotriakhil"><i class="fa fa-github"></i></a></li>
                                    <li><a href="https://scholar.google.com/citations?user=Kf1o27gAAAAJ&hl=en"><i class="fa fa-google"></i></a></li>
                                    <li><a href="https://www.linkedin.com/in/akhil-agnihotri-549690137/"><i class="fa fa-linkedin"></i></a></li>
                                    <li><a href="https://www.facebook.com/akhil.agnihotri.35"><i class="fa fa-facebook"></i></a></li>
                                    <li><a href="https://www.instagram.com/longstory_short_/"><i class="fa fa-instagram"></i></a></li>
                                </ul>
                            </div> -->
                            <!-- <div id="copyright">
                                <i class="fa fa-copyright">Akhil Agnihotri</i>
                            </div> -->
                    
                        </div>
                        <!-- /Sidebar footer -->
                    </div>

                </div>
            </div>

            <div id="main">
            
                <div id="research" class="page">
                    <div class="pageheader">

                        <div class="headercontent">

                            <div class="section-container">
                                <h3 class="title" >Model Predictive Control of Quadruped Robots on Uneven Terrain</h3>
                            
                                <div class="row" style="margin: 0px 0px 0px 10px;">
                                    <div class="col-md">
                                        
                        <img src="images/Spot/Spot.png"  alt="" width="400" height="300" style="vertical-align:middle;margin:0px 180px"/>                
                        <p>Legged robots are gaining tremendous popularity due to their all-terrain locomotion properties. The advantage of legged robots is high-speed locomotion along with less surface coverage which makes them suitable for many applications like rescue, inspection, and exploration. Among all legged robots, quadruped robots are the most researched as they provide maximum functionality with a less complex control. Quadruped robots are designed with three main functionalities; high-speed locomotion, high stability for all kinds of terrains, and high jumping capabilities. <span style="background-color: #FFFF00">This work mainly focuses on the stability of quadruped robots on challenging terrains</span>.</p>
                        <p>In our work, instead of using the Inertial Measurement Unit (IMU) feedback to design the MPC, we use the ground reaction forces at each foot and design a torque based MPC. In addition to this, we are also able to perform gait transitions, provide resistance to external perturbations and sustain falls using MPC. The torque based controller locks the joints at the desired values, thereby reducing vibrations and deviation from set-point. We used the readily available Spot robot by Boston Dynamics in Webots, simulator for testing our controller.</p>

                        
                        <h2>MPC Architecture</h2>
                        <img src="images/Spot/blockdiag.png" alt="" width="800" height="350" style="vertical-align:left;margin:0px 0px"/>                   

                        <p>The input to the quadruped state-space model is the ground reaction forces experienced at each foot. Compared to the classical controllers, MPC has a few advantages, which proves it to be the superior one: </p>
                            <li><span style="background-color: #FFFF00">MPC uses the robot dynamics, for predicting future steps based on the model’s current state. </span> 
                            </li>
                            <li>
                                <span style="background-color: #FFFF00">The controller gains are designed based on a cost function for optimal performance and low overshoots.</span>
                            </li>
                        <p></p>
                        <p>
                            This makes MPC a better candidate for multi-constrained systems like legged robots. Apart from the system model and the tuned weights, the MPC needs the initial and the goal position. Depending on the update frequency, the controller estimates its state with respect to the goal position and recalculates its trajectory from that state towards the final position. Here, the controller corrects the reaction forces, which indirectly means joint torque control of each quadruped leg. Consider a simple standing position of the quadruped on flat ground. Since all four legs of Spot have the same kinematic structure, the jacobian matrix will be the same for all. On flat ground, all the 4 feet will experience equal ground reaction force in x, y, and z-direction. Such conditions for different scenarios are defined and the controller is designed.
                        </p>
                                <p>The <span style="background-color: #FFFF00">mathematical model of the quadruped dynamics</span> used for designing the MPC controller is given below:</p>

                        <img src="images/Spot/potato model.png" alt="" width="600" height="400" style="vertical-align:right;margin:0px 100px"/>
                        
                        <h2>Gait Definition</h2>
                        
                        <img src="images/Spot/gait.png"  alt="" style="vertical-align:middle;margin:0px 0px"/>
                        
                        <p></p>
                        <p>There exist multiple quadrupedal gaits for varying speed and terrain definition. In this work, we have implemented the trot, which is meant for medium pace, and the bound gait for high speed locomotion. <span style="background-color: #FFFF00">While bounding, the Left Front (LF) and Right Front (RF) legs move together followed by the Left Hind (LH) and the Right Hind (RH) legs.</span> The phase difference between the Front and Hind legs is 180°. At a particular instance, only the front or the back legs are in the stance phase while the other two are in swing phase.</p>
                        <p><span style="background-color: #FFFF00">For trot gait, the two diagonally opposite legs move together</span>, i.e., [RH, LF] followed by [RF, LH]. This gait is meant for medium pace and is found to be more suitable for locomotion uneven terrains as well. The robot was made to execute the bounding gait on flat ground and the inclined uneven terrain in Webots. However, to our notice, the robot was not able to follow the terrain transition and got stuck. A feedback check is added to ensure the torso has a continuous motion. If there is no torso motion for defined period of time, the gait transitioning is executed from bound to trot. The gait cycle for bound to trot transition is shown in the diagram below. Gait transitioning is an unstable operation and may result in the robot losing balance and toppling. It needs to be ensured that during the transition phase, the robots center of mass stays within the support polygon formed by the legs in stance phase. The MPC plays a crucial role in the transition phase1. <span style="background-color: #FFFF00">The robot is able to successfully transition from bound to trot and is able to climb uneven terrains up to elevation of 20°</span>.</p>
                            
                        <h2>Results</h2>
                        
                        <p>
                        The above given model is used as a reference for the end-effector trajectory while designing the MPC. It gives an estimate to the controller as to how the future state of the system might be so that it can rightly predict the action required to maintain stability. It must be noted that this model does not perfectly resemble the future system state but only helps in tuning the controller by assuming similar system nature. In case of high update frequency of MPC (50Hz and above), this reference model has negligible importance. This is because the controller estimates the system state and provides correction at a high rate. However, due to hardware limitations and high computation cost, it is not possible to run MPC at frequencies higher than 30 Hz on the actual robot. We have designed the controller for an<span style="background-color: #FFFF00"> update frequency of 20Hz with a sine reference model</span> for simulating uneven terrain. At lower frequencies the reference model plays an important role which can be seen in the figure below. The graph represents the robot’s motion on an uneven terrain recorded for 10 timesteps. For a stable motion, <span style="background-color: #FFFF00">the torso orientation is desired to be [0, 0, z, 0] for [x, y, z, yaw]</span> respectively. The blue curve (a, b, c, d) represents the actual torso motion when sine model was used and the green curve (e, f, g, h) represents the torso motion when the controller was designed using constant reference model.
                        </p>
                        <img src="images/Spot/TorsoMPCwithLegend_final.png"  alt="" width="850" height="500" style="vertical-align:middle;margin:0px 0px"/>
                        <p>
                            The torso stability is maintained at the set-point for the sine model whereas continuously increasing values are found in the constant model depicting unstable nature. In order to test the controller’s performance for external disturbances, an impulse signal was given to the model with a time period of 5 s. The amplitude of the impulse signal was increased for finding the tolerable limit. The controller performance can be seen in the figure below. The torso deviates when force is applied but controller corrects the body pose within 2 s time. The recovery time increases from 2 s to 4.5 s for 150 N disturbance which can be called as the limit. After this point, the next deviation will take place before initial correction which will increase instability and lead to toppling. The controller was tuned in MATLAB and tested on the mathematical model. Later the <span style="background-color: #FFFF00">MPC was designed using gekko optimiser and validated in Webots</span>.
                            </p>
                            <img src="images/Spot/VaryingForceDisturbanceWithLegend_final.png"  alt="" style="vertical-align:middle;margin:0px 80px"/>
    
                        <h2>Conclusion</h2>
                        <p>The quadruped simplified dynamic equations are modelled and simulated in MATLAB. The MPC controller designed in MATLAB is tested for various environmental conditions and shows promising results. The controller is then verified for similar conditions in Webots. A smooth quadrupedal gait transition from high paced bounding to medium paced trot gait is executed successfully. MATLAB and Webots simulations show that the MPC can handle disturbances up to 150 N and is able to sustain falls from heights up to 80 cm. The robot is also able to traverse on inclined uneven surfaces with the help of the MPC.
                        </p>
                        <p>    
                            The future work will focus on designing the other quadrupedal gaits and designing policies for the robot to achieve stable locomotion on more inclined surfaces. Environment mapping will be explored for dynamic trajectory optimisation on the run. We also plan on designing non-periodic gaits to allow locomotion through rocky and sandy terrain by predicting the safe foothold positions using Reinforcement Learning techniques.
                        </p>
                        
                                    </div>
                                    <h2> Related Publications </h2>
                                    <article>
                                        “Terrain Adaptive Gait Transitioning for a Quadruped Robot using Model Predictive Control"
                                        <a href="https://ieeexplore.ieee.org/document/9594065" target="_blank">[Paper]</a>
                                    <p></p>
                                    
                                    <h2> People </h2>
                                    <div class="people project-people">
                                        <div class="person person-with-image row align-items-center">
                                            <div class="row">
                                                <div>
                                                    <a href="/index.html"><img class="rounded-circle profile"	src="images/People/pratha.png" width="75" height="75" /></a>
                                                    <p class="person-name">Prathamesh Saraf</p>
                                                </div>
                                                
                                                <div>
                                                    <a href="https://universe.bits-pilani.ac.in/hyderabad/abhisheks/Profile"><img class="rounded-circle profile" src="images/People/AbhishekSarkar.png" width="75" height="75" /></a>
                                                    <p class="person-name">Prof. Abhishek Sarkar</p>
                                                </div>
                                                
                                                <div>
                                                    <a href="https://www.bits-pilani.ac.in/hyderabad/arshadj/Profile"><img class="rounded-circle profile" src="images/People/arshad.png" width="75" height="75" /></a>
                                                    <p class="person-name">Prof. Arshad Javed</p>
                                                </div>
                                                    
                                            </div>
                                        </div>
                                    </article>           
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </body>
</html>

